<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation startLine="94" startChar="7" endLine="94" endChar="36" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="99" startChar="7" endLine="99" endChar="43" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="104" startChar="7" endLine="104" endChar="37" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="109" startChar="7" endLine="109" endChar="38" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="131" startChar="7" endLine="131" endChar="41" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="136" startChar="7" endLine="136" endChar="48" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="141" startChar="7" endLine="141" endChar="42" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="146" startChar="7" endLine="146" endChar="43" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="233" startChar="5" endLine="233" endChar="34" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="247" startChar="7" endLine="247" endChar="52" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="252" startChar="7" endLine="252" endChar="59" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="257" startChar="7" endLine="257" endChar="53" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="262" startChar="7" endLine="262" endChar="54" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="271" startChar="7" endLine="271" endChar="43" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="276" startChar="7" endLine="276" endChar="50" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="281" startChar="7" endLine="281" endChar="44" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="286" startChar="7" endLine="286" endChar="45" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="333" startChar="5" endLine="333" endChar="36" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="342" startChar="5" endLine="342" endChar="36" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="351" startChar="5" endLine="351" endChar="34" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation startLine="363" startChar="5" endLine="363" endChar="32" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <identifier id="Digoxin_Cyclosporine_CDS" version="1.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localIdentifier="FHIR" uri="http://hl7.org/fhir" version="3.0.0"/>
   </usings>
   <parameters>
      <def name="ContextPrescriptions" accessLevel="Public">
         <parameterTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <valueSets>
      <def name="Digoxin" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-digoxin" accessLevel="Public"/>
      <def name="Cyclosporine" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-cyclosporine" accessLevel="Public"/>
      <def name="Aldosterone Antagonists" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-AAS" accessLevel="Public"/>
      <def name="Loop Diuretics" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-LOOPDIURETIC" accessLevel="Public"/>
      <def name="Digoxin LOINC" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-digoxin-LOINC" accessLevel="Public"/>
      <def name="Potassium LOINC" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-potassium-LOINC" accessLevel="Public"/>
      <def name="Magnesium LOINC" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-magnesium-LOINC" accessLevel="Public"/>
      <def name="Calcium LOINC" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-calcium-LOINC" accessLevel="Public"/>
      <def name="Renal LOINC" id="http://hl7.org/fhir/ig/PDDI-CDS/ValueSet/valueset-renal-LOINC" accessLevel="Public"/>
   </valueSets>
   <statements>
      <def name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand dataType="fhir:Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def name="GetConditionName" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand xsi:type="Not">
                  <operand xsi:type="IsNull">
                     <operand name="condition" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </condition>
            <then path="value" xsi:type="Property">
               <source path="display" xsi:type="Property">
                  <source xsi:type="Indexer">
                     <operand path="coding" xsi:type="Property">
                        <source path="code" xsi:type="Property">
                           <source name="condition" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                     <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                  </source>
               </source>
            </then>
            <else valueType="t:String" value="NA" xsi:type="Literal"/>
         </expression>
         <operand name="condition">
            <operandTypeSpecifier name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="GetAssertedDate" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand xsi:type="Not">
                  <operand xsi:type="IsNull">
                     <operand name="condition" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </condition>
            <then xsi:type="ToString">
               <operand path="value" xsi:type="Property">
                  <source path="assertedDate" xsi:type="Property">
                     <source name="condition" xsi:type="OperandRef"/>
                  </source>
               </operand>
            </then>
            <else valueType="t:String" value="NA" xsi:type="Literal"/>
         </expression>
         <operand name="condition">
            <operandTypeSpecifier name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="ToQuantity" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression classType="t:Quantity" xsi:type="Instance">
            <element name="value">
               <value path="value" xsi:type="Property">
                  <source path="value" xsi:type="Property">
                     <source name="quantity" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="unit">
               <value path="value" xsi:type="Property">
                  <source path="unit" xsi:type="Property">
                     <source name="quantity" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
         </expression>
         <operand name="quantity">
            <operandTypeSpecifier name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="GetLevelAndDate" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand xsi:type="Not">
                  <operand xsi:type="IsNull">
                     <operand name="observation" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </condition>
            <then xsi:type="Concatenate">
               <operand xsi:type="Concatenate">
                  <operand xsi:type="ToString">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand strict="false" xsi:type="As">
                           <operand path="value" xsi:type="Property">
                              <source name="observation" xsi:type="OperandRef"/>
                           </operand>
                           <asTypeSpecifier name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand valueType="t:String" value=" and " xsi:type="Literal"/>
               </operand>
               <operand xsi:type="ToString">
                  <operand path="value" xsi:type="Property">
                     <source path="effective" xsi:type="Property">
                        <source name="observation" xsi:type="OperandRef"/>
                     </source>
                  </operand>
               </operand>
            </then>
            <else valueType="t:String" value="NA" xsi:type="Literal"/>
         </expression>
         <operand name="observation">
            <operandTypeSpecifier name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="ToCode" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression classType="t:Code" xsi:type="Instance">
            <element name="code">
               <value path="value" xsi:type="Property">
                  <source path="code" xsi:type="Property">
                     <source name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="system">
               <value path="value" xsi:type="Property">
                  <source path="system" xsi:type="Property">
                     <source name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="version">
               <value path="value" xsi:type="Property">
                  <source path="version" xsi:type="Property">
                     <source name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="display">
               <value path="value" xsi:type="Property">
                  <source path="display" xsi:type="Property">
                     <source name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
         </expression>
         <operand name="coding">
            <operandTypeSpecifier name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="GetMedicationNames" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression xsi:type="Query">
            <source alias="M">
               <expression name="medications" xsi:type="OperandRef"/>
            </source>
            <return>
               <expression path="display" xsi:type="Property">
                  <source name="ToCode" xsi:type="FunctionRef">
                     <operand xsi:type="Indexer">
                        <operand path="coding" xsi:type="Property">
                           <source path="medication" scope="M" xsi:type="Property"/>
                        </operand>
                        <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                     </operand>
                  </source>
               </expression>
            </return>
         </expression>
         <operand name="medications">
            <operandTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def name="GetDrugNames" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression xsi:type="Combine">
            <source xsi:type="Flatten">
               <operand xsi:type="Query">
                  <source alias="X">
                     <expression xsi:type="Query">
                        <source alias="coding">
                           <expression name="codings" xsi:type="OperandRef"/>
                        </source>
                        <return>
                           <expression path="display" xsi:type="Property">
                              <source name="ToCode" xsi:type="FunctionRef">
                                 <operand name="coding" xsi:type="AliasRef"/>
                              </source>
                           </expression>
                        </return>
                     </expression>
                  </source>
                  <return distinct="false">
                     <expression xsi:type="ToList">
                        <operand name="X" xsi:type="AliasRef"/>
                     </expression>
                  </return>
               </operand>
            </source>
            <separator valueType="t:String" value=", " xsi:type="Literal"/>
         </expression>
         <operand name="codings">
            <operandTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def name="ToString" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression path="value" xsi:type="Property">
            <source path="display" xsi:type="Property">
               <source name="value" xsi:type="OperandRef"/>
            </source>
         </expression>
         <operand name="value">
            <operandTypeSpecifier name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="ToString" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <expression path="display" xsi:type="Property">
            <source name="value" xsi:type="OperandRef"/>
         </expression>
         <operand name="value">
            <operandTypeSpecifier name="t:Code" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def name="Cyclosporine Prescription" context="Patient" accessLevel="Public">
         <expression xsi:type="Query">
            <source alias="P">
               <expression name="ContextPrescriptions" xsi:type="ParameterRef"/>
            </source>
            <where xsi:type="InValueSet">
               <code name="ToCode" xsi:type="FunctionRef">
                  <operand xsi:type="Indexer">
                     <operand path="coding" xsi:type="Property">
                        <source path="medication" scope="P" xsi:type="Property"/>
                     </operand>
                     <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                  </operand>
               </code>
               <valueset name="Cyclosporine"/>
            </where>
            <return>
               <expression xsi:type="Indexer">
                  <operand path="coding" xsi:type="Property">
                     <source path="medication" scope="P" xsi:type="Property"/>
                  </operand>
                  <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
               </expression>
            </return>
         </expression>
      </def>
      <def name="Is Context medication cyclosporine" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand name="Cyclosporine Prescription" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Digoxin Rx" context="Patient" accessLevel="Public">
         <expression xsi:type="Flatten">
            <operand xsi:type="Query">
               <source alias="X">
                  <expression xsi:type="Union">
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MR">
                              <expression dataType="fhir:MedicationRequest" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Digoxin" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="authoredOn" scope="MR" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MR" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MA">
                              <expression dataType="fhir:MedicationAdministration" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Digoxin" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MA" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MA" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MD">
                              <expression dataType="fhir:MedicationDispense" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Digoxin" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="whenHandedOver" scope="MD" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MD" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MS">
                              <expression dataType="fhir:MedicationStatement" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Digoxin" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MS" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MS" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </expression>
               </source>
               <return distinct="false">
                  <expression xsi:type="ToList">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </operand>
         </expression>
      </def>
      <def name="Is digoxin in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand name="Digoxin Rx" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Digoxin Prescription" context="Patient" accessLevel="Public">
         <expression xsi:type="Query">
            <source alias="P">
               <expression name="ContextPrescriptions" xsi:type="ParameterRef"/>
            </source>
            <where xsi:type="InValueSet">
               <code name="ToCode" xsi:type="FunctionRef">
                  <operand xsi:type="Indexer">
                     <operand path="coding" xsi:type="Property">
                        <source path="medication" scope="P" xsi:type="Property"/>
                     </operand>
                     <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                  </operand>
               </code>
               <valueset name="Digoxin"/>
            </where>
            <return>
               <expression xsi:type="Indexer">
                  <operand path="coding" xsi:type="Property">
                     <source path="medication" scope="P" xsi:type="Property"/>
                  </operand>
                  <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
               </expression>
            </return>
         </expression>
      </def>
      <def name="Is Context medication digoxin" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand name="Digoxin Prescription" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Cyclosporine Rx" context="Patient" accessLevel="Public">
         <expression xsi:type="Flatten">
            <operand xsi:type="Query">
               <source alias="X">
                  <expression xsi:type="Union">
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MR">
                              <expression dataType="fhir:MedicationRequest" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Cyclosporine" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="authoredOn" scope="MR" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MR" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MA">
                              <expression dataType="fhir:MedicationAdministration" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Cyclosporine" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MA" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MA" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MD">
                              <expression dataType="fhir:MedicationDispense" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Cyclosporine" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="whenHandedOver" scope="MD" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MD" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MS">
                              <expression dataType="fhir:MedicationStatement" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Cyclosporine" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MS" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MS" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </expression>
               </source>
               <return distinct="false">
                  <expression xsi:type="ToList">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </operand>
         </expression>
      </def>
      <def name="Is cyclosporine in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand name="Cyclosporine Rx" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Inclusion Criteria" context="Patient" accessLevel="Public">
         <expression xsi:type="Or">
            <operand xsi:type="And">
               <operand name="Is Context medication cyclosporine" xsi:type="ExpressionRef"/>
               <operand name="Is digoxin in prefetch" xsi:type="ExpressionRef"/>
            </operand>
            <operand xsi:type="And">
               <operand name="Is Context medication digoxin" xsi:type="ExpressionRef"/>
               <operand name="Is cyclosporine in prefetch" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Get Base Summary" context="Patient" accessLevel="Public">
         <expression xsi:type="Concatenate">
            <operand xsi:type="Concatenate">
               <operand xsi:type="Concatenate">
                  <operand xsi:type="Concatenate">
                     <operand valueType="t:String" value="Potential Drug-Drug Interaction between digoxin (" xsi:type="Literal"/>
                     <operand xsi:type="If">
                        <condition asType="t:Boolean" xsi:type="As">
                           <operand name="Is Context medication digoxin" xsi:type="ExpressionRef"/>
                        </condition>
                        <then name="GetDrugNames" xsi:type="FunctionRef">
                           <operand name="Digoxin Prescription" xsi:type="ExpressionRef"/>
                        </then>
                        <else name="GetDrugNames" xsi:type="FunctionRef">
                           <operand name="Digoxin Rx" xsi:type="ExpressionRef"/>
                        </else>
                     </operand>
                  </operand>
                  <operand valueType="t:String" value=") and cyclosporine (" xsi:type="Literal"/>
               </operand>
               <operand xsi:type="If">
                  <condition asType="t:Boolean" xsi:type="As">
                     <operand name="Is Context medication cyclosporine" xsi:type="ExpressionRef"/>
                  </condition>
                  <then name="GetDrugNames" xsi:type="FunctionRef">
                     <operand name="Cyclosporine Prescription" xsi:type="ExpressionRef"/>
                  </then>
                  <else name="GetDrugNames" xsi:type="FunctionRef">
                     <operand name="Cyclosporine Rx" xsi:type="ExpressionRef"/>
                  </else>
               </operand>
            </operand>
            <operand valueType="t:String" value=")" xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Get Base Detail" context="Patient" accessLevel="Public">
         <expression valueType="t:String" value="Increased risk of digoxin toxicity. Assess risk and take action if necessary. &#xa;Digoxin toxicity is potentially serious. The clinical consequences may include anorexia, nausea, vomiting, visual changes, and cardiac arrhythmias. &#xa;The mechanism of this interaction appears to be mediated through P-glycoprotein inhibition by cyclosporine. P-glycoprotein is a major transporter for digoxin efflux. &#xa;unknown. &#xa;unknown." xsi:type="Literal"/>
      </def>
      <def name="Is continuation order for digoxin" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand name="Is Context medication digoxin" xsi:type="ExpressionRef"/>
            <operand name="Is digoxin in prefetch" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Is continuation order for cyclosporine" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand name="Is Context medication cyclosporine" xsi:type="ExpressionRef"/>
            <operand name="Is cyclosporine in prefetch" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Normal Digoxin Observation" context="Patient" accessLevel="Public">
         <expression xsi:type="Last">
            <source xsi:type="Query">
               <source alias="O">
                  <expression dataType="fhir:Observation" codeProperty="code" xsi:type="Retrieve">
                     <codes name="Digoxin LOINC" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where xsi:type="And">
                  <operand xsi:type="In">
                     <operand path="value" xsi:type="Property">
                        <source path="effective" scope="O" xsi:type="Property"/>
                     </operand>
                     <operand xsi:type="Interval">
                        <low xsi:type="ToDateTime">
                           <operand path="low" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="30" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </operand>
                        </low>
                        <lowClosedExpression path="lowClosed" xsi:type="Property">
                           <source lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low xsi:type="Subtract">
                                 <operand xsi:type="Today"/>
                                 <operand value="30" unit="days" xsi:type="Quantity"/>
                              </low>
                              <high asType="t:Date" xsi:type="As">
                                 <operand xsi:type="Null"/>
                              </high>
                           </source>
                        </lowClosedExpression>
                        <high xsi:type="ToDateTime">
                           <operand path="high" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="30" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </operand>
                        </high>
                        <highClosedExpression path="highClosed" xsi:type="Property">
                           <source lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low xsi:type="Subtract">
                                 <operand xsi:type="Today"/>
                                 <operand value="30" unit="days" xsi:type="Quantity"/>
                              </low>
                              <high asType="t:Date" xsi:type="As">
                                 <operand xsi:type="Null"/>
                              </high>
                           </source>
                        </highClosedExpression>
                     </operand>
                  </operand>
                  <operand xsi:type="Less">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand asType="fhir:Quantity" xsi:type="As">
                           <operand path="value" scope="O" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand value="0.9" unit="ng/mL" xsi:type="Quantity"/>
                  </operand>
               </where>
               <sort>
                  <by direction="asc" xsi:type="ByExpression">
                     <expression path="value" xsi:type="Property">
                        <source name="effective" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
      </def>
      <def name="Is there a normal digoxin level in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand xsi:type="ToList">
               <operand name="Normal Digoxin Observation" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Aldosterone Antagonists Rx" context="Patient" accessLevel="Public">
         <expression xsi:type="Flatten">
            <operand xsi:type="Query">
               <source alias="X">
                  <expression xsi:type="Union">
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MR">
                              <expression dataType="fhir:MedicationRequest" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Aldosterone Antagonists" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="authoredOn" scope="MR" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MR" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MA">
                              <expression dataType="fhir:MedicationAdministration" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Aldosterone Antagonists" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MA" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MA" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MD">
                              <expression dataType="fhir:MedicationDispense" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Aldosterone Antagonists" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="whenHandedOver" scope="MD" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MD" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MS">
                              <expression dataType="fhir:MedicationStatement" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Aldosterone Antagonists" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MS" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MS" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </expression>
               </source>
               <return distinct="false">
                  <expression xsi:type="ToList">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </operand>
         </expression>
      </def>
      <def name="Loop Diuretics Rx" context="Patient" accessLevel="Public">
         <expression xsi:type="Flatten">
            <operand xsi:type="Query">
               <source alias="X">
                  <expression xsi:type="Union">
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MR">
                              <expression dataType="fhir:MedicationRequest" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Loop Diuretics" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="authoredOn" scope="MR" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MR" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MA">
                              <expression dataType="fhir:MedicationAdministration" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Loop Diuretics" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MA" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MA" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                     <operand xsi:type="Union">
                        <operand xsi:type="Query">
                           <source alias="MD">
                              <expression dataType="fhir:MedicationDispense" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Loop Diuretics" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="whenHandedOver" scope="MD" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MD" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                        <operand xsi:type="Query">
                           <source alias="MS">
                              <expression dataType="fhir:MedicationStatement" codeProperty="medication" xsi:type="Retrieve">
                                 <codes name="Loop Diuretics" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where xsi:type="In">
                              <operand path="value" xsi:type="Property">
                                 <source path="effective" scope="MS" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="Interval">
                                 <low xsi:type="ToDateTime">
                                    <operand path="low" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </low>
                                 <lowClosedExpression path="lowClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </lowClosedExpression>
                                 <high xsi:type="ToDateTime">
                                    <operand path="high" xsi:type="Property">
                                       <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                          <low xsi:type="Subtract">
                                             <operand xsi:type="Today"/>
                                             <operand value="100" unit="days" xsi:type="Quantity"/>
                                          </low>
                                          <high asType="t:Date" xsi:type="As">
                                             <operand xsi:type="Null"/>
                                          </high>
                                       </source>
                                    </operand>
                                 </high>
                                 <highClosedExpression path="highClosed" xsi:type="Property">
                                    <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                       <low xsi:type="Subtract">
                                          <operand xsi:type="Today"/>
                                          <operand value="100" unit="days" xsi:type="Quantity"/>
                                       </low>
                                       <high asType="t:Date" xsi:type="As">
                                          <operand xsi:type="Null"/>
                                       </high>
                                    </source>
                                 </highClosedExpression>
                              </operand>
                           </where>
                           <return>
                              <expression xsi:type="Indexer">
                                 <operand path="coding" xsi:type="Property">
                                    <source path="medication" scope="MS" xsi:type="Property"/>
                                 </operand>
                                 <operand valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </expression>
               </source>
               <return distinct="false">
                  <expression xsi:type="ToList">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </operand>
         </expression>
      </def>
      <def name="Are diuretics in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Or">
            <operand xsi:type="Exists">
               <operand name="Aldosterone Antagonists Rx" xsi:type="ExpressionRef"/>
            </operand>
            <operand xsi:type="Exists">
               <operand name="Loop Diuretics Rx" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Normal Potassium Observation" context="Patient" accessLevel="Public">
         <expression xsi:type="Last">
            <source xsi:type="Query">
               <source alias="O">
                  <expression dataType="fhir:Observation" codeProperty="code" xsi:type="Retrieve">
                     <codes name="Potassium LOINC" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where xsi:type="And">
                  <operand xsi:type="And">
                     <operand xsi:type="In">
                        <operand path="value" xsi:type="Property">
                           <source path="effective" scope="O" xsi:type="Property"/>
                        </operand>
                        <operand xsi:type="Interval">
                           <low xsi:type="ToDateTime">
                              <operand path="low" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </low>
                           <lowClosedExpression path="lowClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </lowClosedExpression>
                           <high xsi:type="ToDateTime">
                              <operand path="high" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </high>
                           <highClosedExpression path="highClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </highClosedExpression>
                        </operand>
                     </operand>
                     <operand xsi:type="Greater">
                        <operand name="ToQuantity" xsi:type="FunctionRef">
                           <operand asType="fhir:Quantity" xsi:type="As">
                              <operand path="value" scope="O" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand value="3.5" unit="mEq/L" xsi:type="Quantity"/>
                     </operand>
                  </operand>
                  <operand xsi:type="Less">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand asType="fhir:Quantity" xsi:type="As">
                           <operand path="value" scope="O" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand value="5.0" unit="mEq/L" xsi:type="Quantity"/>
                  </operand>
               </where>
               <sort>
                  <by direction="asc" xsi:type="ByExpression">
                     <expression path="value" xsi:type="Property">
                        <source name="effective" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
      </def>
      <def name="Normal Magnesium Observation" context="Patient" accessLevel="Public">
         <expression xsi:type="Last">
            <source xsi:type="Query">
               <source alias="O">
                  <expression dataType="fhir:Observation" codeProperty="code" xsi:type="Retrieve">
                     <codes name="Magnesium LOINC" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where xsi:type="And">
                  <operand xsi:type="And">
                     <operand xsi:type="In">
                        <operand path="value" xsi:type="Property">
                           <source path="effective" scope="O" xsi:type="Property"/>
                        </operand>
                        <operand xsi:type="Interval">
                           <low xsi:type="ToDateTime">
                              <operand path="low" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </low>
                           <lowClosedExpression path="lowClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </lowClosedExpression>
                           <high xsi:type="ToDateTime">
                              <operand path="high" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </high>
                           <highClosedExpression path="highClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </highClosedExpression>
                        </operand>
                     </operand>
                     <operand xsi:type="Greater">
                        <operand name="ToQuantity" xsi:type="FunctionRef">
                           <operand asType="fhir:Quantity" xsi:type="As">
                              <operand path="value" scope="O" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand value="0.7" unit="mmol/L" xsi:type="Quantity"/>
                     </operand>
                  </operand>
                  <operand xsi:type="Less">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand asType="fhir:Quantity" xsi:type="As">
                           <operand path="value" scope="O" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand value="1.1" unit="mmol/L" xsi:type="Quantity"/>
                  </operand>
               </where>
               <sort>
                  <by direction="asc" xsi:type="ByExpression">
                     <expression path="value" xsi:type="Property">
                        <source name="effective" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
      </def>
      <def name="Normal Calcium Observation" context="Patient" accessLevel="Public">
         <expression xsi:type="Last">
            <source xsi:type="Query">
               <source alias="O">
                  <expression dataType="fhir:Observation" codeProperty="code" xsi:type="Retrieve">
                     <codes name="Calcium LOINC" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where xsi:type="And">
                  <operand xsi:type="And">
                     <operand xsi:type="In">
                        <operand path="value" xsi:type="Property">
                           <source path="effective" scope="O" xsi:type="Property"/>
                        </operand>
                        <operand xsi:type="Interval">
                           <low xsi:type="ToDateTime">
                              <operand path="low" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </low>
                           <lowClosedExpression path="lowClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </lowClosedExpression>
                           <high xsi:type="ToDateTime">
                              <operand path="high" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </high>
                           <highClosedExpression path="highClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </highClosedExpression>
                        </operand>
                     </operand>
                     <operand xsi:type="Greater">
                        <operand name="ToQuantity" xsi:type="FunctionRef">
                           <operand asType="fhir:Quantity" xsi:type="As">
                              <operand path="value" scope="O" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand value="8.5" unit="mg/dL" xsi:type="Quantity"/>
                     </operand>
                  </operand>
                  <operand xsi:type="Less">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand asType="fhir:Quantity" xsi:type="As">
                           <operand path="value" scope="O" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand value="10.2" unit="mg/dL" xsi:type="Quantity"/>
                  </operand>
               </where>
               <sort>
                  <by direction="asc" xsi:type="ByExpression">
                     <expression path="value" xsi:type="Property">
                        <source name="effective" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
      </def>
      <def name="Is there a normal electrolyte observation in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand xsi:type="And">
               <operand xsi:type="Exists">
                  <operand xsi:type="ToList">
                     <operand name="Normal Potassium Observation" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
               <operand xsi:type="Exists">
                  <operand xsi:type="ToList">
                     <operand name="Normal Magnesium Observation" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
            </operand>
            <operand xsi:type="Exists">
               <operand xsi:type="ToList">
                  <operand name="Normal Calcium Observation" xsi:type="ExpressionRef"/>
               </operand>
            </operand>
         </expression>
      </def>
      <def name="Normal Renal Observation" context="Patient" accessLevel="Public">
         <expression xsi:type="Last">
            <source xsi:type="Query">
               <source alias="O">
                  <expression dataType="fhir:Observation" codeProperty="code" xsi:type="Retrieve">
                     <codes name="Renal LOINC" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where xsi:type="And">
                  <operand xsi:type="And">
                     <operand xsi:type="In">
                        <operand path="value" xsi:type="Property">
                           <source path="effective" scope="O" xsi:type="Property"/>
                        </operand>
                        <operand xsi:type="Interval">
                           <low xsi:type="ToDateTime">
                              <operand path="low" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </low>
                           <lowClosedExpression path="lowClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </lowClosedExpression>
                           <high xsi:type="ToDateTime">
                              <operand path="high" xsi:type="Property">
                                 <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low xsi:type="Subtract">
                                       <operand xsi:type="Today"/>
                                       <operand value="365" unit="days" xsi:type="Quantity"/>
                                    </low>
                                    <high asType="t:Date" xsi:type="As">
                                       <operand xsi:type="Null"/>
                                    </high>
                                 </source>
                              </operand>
                           </high>
                           <highClosedExpression path="highClosed" xsi:type="Property">
                              <source lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low xsi:type="Subtract">
                                    <operand xsi:type="Today"/>
                                    <operand value="365" unit="days" xsi:type="Quantity"/>
                                 </low>
                                 <high asType="t:Date" xsi:type="As">
                                    <operand xsi:type="Null"/>
                                 </high>
                              </source>
                           </highClosedExpression>
                        </operand>
                     </operand>
                     <operand xsi:type="Greater">
                        <operand name="ToQuantity" xsi:type="FunctionRef">
                           <operand asType="fhir:Quantity" xsi:type="As">
                              <operand path="value" scope="O" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand value="0.6" unit="mg/dL" xsi:type="Quantity"/>
                     </operand>
                  </operand>
                  <operand xsi:type="Less">
                     <operand name="ToQuantity" xsi:type="FunctionRef">
                        <operand asType="fhir:Quantity" xsi:type="As">
                           <operand path="value" scope="O" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand value="1.2" unit="mg/dL" xsi:type="Quantity"/>
                  </operand>
               </where>
               <sort>
                  <by direction="asc" xsi:type="ByExpression">
                     <expression path="value" xsi:type="Property">
                        <source name="effective" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
      </def>
      <def name="Is there a normal renal observation in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Exists">
            <operand xsi:type="ToList">
               <operand name="Normal Renal Observation" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Is there a normal electrolyte and renal observation in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand name="Is there a normal electrolyte observation in prefetch" xsi:type="ExpressionRef"/>
            <operand name="Is there a normal renal observation in prefetch" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def name="Are diuretics or abnormal electrolyte or abnormal renal observations in prefetch" context="Patient" accessLevel="Public">
         <expression xsi:type="Or">
            <operand name="Are diuretics in prefetch" xsi:type="ExpressionRef"/>
            <operand xsi:type="Not">
               <operand name="Is there a normal electrolyte and renal observation in prefetch" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Get Base Indicator" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand xsi:type="Or">
                  <operand name="Is continuation order for digoxin" xsi:type="ExpressionRef"/>
                  <operand name="Is continuation order for cyclosporine" xsi:type="ExpressionRef"/>
               </operand>
            </condition>
            <then xsi:type="If">
               <condition asType="t:Boolean" xsi:type="As">
                  <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
               </condition>
               <then xsi:type="If">
                  <condition asType="t:Boolean" xsi:type="As">
                     <operand name="Are diuretics or abnormal electrolyte or abnormal renal observations in prefetch" xsi:type="ExpressionRef"/>
                  </condition>
                  <then valueType="t:String" value="warning" xsi:type="Literal"/>
                  <else valueType="t:String" value="info" xsi:type="Literal"/>
               </then>
               <else valueType="t:String" value="warning" xsi:type="Literal"/>
            </then>
            <else valueType="t:String" value="warning" xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Is new order for digoxin" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand name="Is Context medication digoxin" xsi:type="ExpressionRef"/>
            <operand xsi:type="Not">
               <operand name="Is digoxin in prefetch" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Is new order for cyclosporine" context="Patient" accessLevel="Public">
         <expression xsi:type="And">
            <operand name="Is Context medication cyclosporine" xsi:type="ExpressionRef"/>
            <operand xsi:type="Not">
               <operand name="Is cyclosporine in prefetch" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Get Card 2 Indicator" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is new order for cyclosporine" xsi:type="ExpressionRef"/>
            </condition>
            <then xsi:type="If">
               <condition asType="t:Boolean" xsi:type="As">
                  <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
               </condition>
               <then valueType="t:String" value="warning" xsi:type="Literal"/>
               <else valueType="t:String" value="critical" xsi:type="Literal"/>
            </then>
            <else xsi:type="If">
               <condition asType="t:Boolean" xsi:type="As">
                  <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
               </condition>
               <then valueType="t:String" value="info" xsi:type="Literal"/>
               <else valueType="t:String" value="warning" xsi:type="Literal"/>
            </else>
         </expression>
      </def>
      <def name="Get Card 2 Summary" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
            </condition>
            <then valueType="t:String" value="Patient has digoxin level within 30 days that is below 0.9 ng/mL (SI: 1.2 nmol/L)" xsi:type="Literal"/>
            <else valueType="t:String" value="Patient does not have digoxin level on record within the last 30 days. " xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Get Card 2 Detail" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
            </condition>
            <then xsi:type="Concatenate">
               <operand xsi:type="Concatenate">
                  <operand valueType="t:String" value="(Digoxin: " xsi:type="Literal"/>
                  <operand name="GetLevelAndDate" xsi:type="FunctionRef">
                     <operand name="Normal Digoxin Observation" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
               <operand valueType="t:String" value="). &#xa;For patients with a reliable plasma digoxin concentration in normal range, it is reasonable to anticipate an increase in plasma concentrations after the initiation of cyclosporine. Following initiation, close monitoring and adjusting the digoxin dose as needed is recommended" xsi:type="Literal"/>
            </then>
            <else valueType="t:String" value="Initiating cyclosporine is expected to increase digoxin levels. For patients without a reliable plasma digoxin concentration in normal range, use only if benefits outweight risks. Extreme caution and close monitoring is necessary." xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Need to reduce Digoxin dose" context="Patient" accessLevel="Public">
         <expression xsi:type="Or">
            <operand name="Is Context medication cyclosporine" xsi:type="ExpressionRef"/>
            <operand xsi:type="Not">
               <operand name="Is there a normal digoxin level in prefetch" xsi:type="ExpressionRef"/>
            </operand>
         </expression>
      </def>
      <def name="Get Card 3 Indicator" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is there a normal electrolyte and renal observation in prefetch" xsi:type="ExpressionRef"/>
            </condition>
            <then valueType="t:String" value="info" xsi:type="Literal"/>
            <else valueType="t:String" value="warning" xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Get Card 3 Summary" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is there a normal electrolyte and renal observation in prefetch" xsi:type="ExpressionRef"/>
            </condition>
            <then valueType="t:String" value="Within 100 days, the patient has had electrolyte and serum creatinine levels checked, and they are not on a potassium sparing or loop diuretic." xsi:type="Literal"/>
            <else valueType="t:String" value="Within 100 days, the patient has not had an electrolyte panel. The patient does have serum creatinine level and is not on a potassium sparing or loop diuretic." xsi:type="Literal"/>
         </expression>
      </def>
      <def name="Get Card 3 Detail" context="Patient" accessLevel="Public">
         <expression xsi:type="If">
            <condition asType="t:Boolean" xsi:type="As">
               <operand name="Is there a normal electrolyte and renal observation in prefetch" xsi:type="ExpressionRef"/>
            </condition>
            <then xsi:type="Concatenate">
               <operand xsi:type="Concatenate">
                  <operand xsi:type="Concatenate">
                     <operand xsi:type="Concatenate">
                        <operand xsi:type="Concatenate">
                           <operand xsi:type="Concatenate">
                              <operand valueType="t:String" value="(Potassium: " xsi:type="Literal"/>
                              <operand name="GetLevelAndDate" xsi:type="FunctionRef">
                                 <operand name="Normal Potassium Observation" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand valueType="t:String" value=")&#xa; (Magnesium: " xsi:type="Literal"/>
                        </operand>
                        <operand name="GetLevelAndDate" xsi:type="FunctionRef">
                           <operand name="Normal Magnesium Observation" xsi:type="ExpressionRef"/>
                        </operand>
                     </operand>
                     <operand valueType="t:String" value=")&#xa; (Calcium: " xsi:type="Literal"/>
                  </operand>
                  <operand name="GetLevelAndDate" xsi:type="FunctionRef">
                     <operand name="Normal Calcium Observation" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
               <operand valueType="t:String" value=")&#xa;" xsi:type="Literal"/>
            </then>
            <else xsi:type="Concatenate">
               <operand xsi:type="Concatenate">
                  <operand xsi:type="Concatenate">
                     <operand valueType="t:String" value="" xsi:type="Literal"/>
                     <operand valueType="t:String" value="(Serum creatinine: " xsi:type="Literal"/>
                  </operand>
                  <operand name="GetLevelAndDate" xsi:type="FunctionRef">
                     <operand name="Normal Renal Observation" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
               <operand valueType="t:String" value=")&#xa; Hypokalemia, hypomagnesemia, and hypercalcemia may potentiate digoxin toxicity. 50-70% of digoxin is excreted unchanged in the urine. Changing renal function may increase serum concentrations and risk of toxicity." xsi:type="Literal"/>
            </else>
         </expression>
      </def>
   </statements>
</library>


